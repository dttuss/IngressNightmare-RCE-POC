âš ï¸ Critical RCE in Ingress-NGINX via Configuration Injection (**CVE-2025-1974** and more)<br><br>This repository contains a proof-of-concept (PoC) exploit for **CVE-2025-1974**, a Critical (**CVSS 9.8**) vulnerability in the Ingress-NGINX controller for Kubernetes. This flaw allows unauthenticated remote code execution via unsafe configuration injection when using the Validating Admission Controller. It is the most serious of a set of five vulnerabilities disclosed and patched on March 26, 2025.<br><br>ğŸ“Œ Impact:<br>â€¢ Affected Versions: Ingress-NGINX controller prior to v1.12.1 / v1.11.5<br>â€¢ Attack Surface:<br>â€ƒâ€¢ Exploitable by any workload on the Pod network â€” no credentials or admin privileges required<br>â€ƒâ€¢ Attackers can inject arbitrary NGINX directives (e.g., content_by_lua_block) via annotations like configuration-snippet<br>â€ƒâ€¢ When combined with misconfigurations, attackers can exfiltrate Secrets or achieve full cluster compromise<br>â€¢ Scope:<br>â€ƒâ€¢ Ingress-NGINX often has access to all cluster Secrets by default<br>â€ƒâ€¢ Pods in a typical cloud VPC or corporate network can reach the admission controller endpoint<br>â€ƒâ€¢ Affected clusters include those running Ingress-NGINX with admission control enabled (default in many setups)<br><br>ğŸ›¡ï¸ Mitigation:<br>â€¢ Upgrade to Ingress-NGINX v1.12.1 or v1.11.5<br>â€¢ Disable risky annotations (configuration-snippet, server-snippet, etc.)<br>â€¢ Lock down network access to the Validating Admission Webhook<br>â€¢ Apply strict RBAC to prevent unauthorized Ingress creation<br><br>ğŸ§ª This PoC demonstrates how attackers can leverage the vulnerability to run arbitrary code inside the ingress controller pod â€” which often has access to internal services and secrets â€” escalating to full cluster takeover in vulnerable configurations.<br><br>ğŸš¨ Disclaimer: This PoC is for educational and research purposes only. Do not use it without explicit permission.
